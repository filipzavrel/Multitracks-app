<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Výběr a úprava písní</title>
    <link rel="stylesheet" href="style.css">
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #333;
        }
        #songInput {
            display: block;
            margin: 20px auto;
            padding: 10px;
            font-size: 16px;
        }
        #songList {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin-top: 20px;
        }
        .song-button {
            background-color: #007bff;
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 16px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .song-button:hover {
            background-color: #0056b3;
        }
        #trackControls {
            margin-top: 30px;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }
        .track-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 15px;
            border-bottom: 1px solid #ccc;
        }
        .track-label {
            flex: 2;
            font-weight: bold;
            color: #333;
        }
        .play-button, .stop-button {
            background-color: #28a745;
            color: white;
            border: none;
            padding: 10px;
            margin-right: 10px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .play-button:hover, .stop-button:hover {
            background-color: #218838;
        }
        .volume-control {
            margin-left: 15px;
            flex: 1;
        }
        .progress-bar {
            flex: 2;
            margin: 0 15px;
        }
        .track-checkbox {
            margin-right: 15px;
        }
        .play-selected-button, .stop-selected-button {
            display: block;
            margin: 20px auto;
            background-color: #ff5722;
            color: white;
            border: none;
            padding: 15px 20px;
            font-size: 18px;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .play-selected-button:hover, .stop-selected-button:hover {
            background-color: #e64a19;
        }
    </style>
</head>
<body>
    <h1>Výběr písně a úprava stop</h1>
    <label for="songInput">Nahrajte složku s písněmi:</label>
    <input type="file" id="songInput" webkitdirectory multiple>
    <div id="songList"></div>
    <div id="trackControls"></div>
    <script>
        document.addEventListener("DOMContentLoaded", () => {
            const songInput = document.getElementById('songInput');
            const songList = document.getElementById('songList');
            const trackControls = document.getElementById('trackControls');
            const playSelectedButton = document.createElement('button');
            const stopSelectedButton = document.createElement('button');
            let audioElements = [];

            playSelectedButton.textContent = 'Přehrát vybrané';
            playSelectedButton.className = 'play-selected-button';
            stopSelectedButton.textContent = 'Zastavit vybrané';
            stopSelectedButton.className = 'stop-selected-button';

            songInput.addEventListener('change', (event) => {
                const files = Array.from(event.target.files);
                const songFolders = {};

                // Roztřídit soubory podle složek (písní)
                files.forEach(file => {
                    const folderName = file.webkitRelativePath.split('/')[1];
                    if (!songFolders[folderName]) {
                        songFolders[folderName] = [];
                    }
                    songFolders[folderName].push(file);
                });

                displaySongList(songFolders);
            });

            function displaySongList(songFolders) {
                songList.innerHTML = ''; // Vymazání předchozího seznamu písní
                trackControls.innerHTML = ''; // Vymazání předchozích ovládacích prvků
                audioElements = []; // Vymazání předchozích zvukových prvků

                Object.keys(songFolders).forEach(folderName => {
                    const songButton = document.createElement('button');
                    songButton.textContent = folderName;
                    songButton.className = 'song-button';
                    songButton.addEventListener('click', () => {
                        loadTracks(songFolders[folderName]);
                    });
                    songList.appendChild(songButton);
                });
            }

            function loadTracks(tracks) {
                trackControls.innerHTML = ''; // Vymazání předchozích ovládacích prvků
                audioElements = []; // Vymazání předchozích zvukových prvků

                trackControls.appendChild(playSelectedButton);
                trackControls.appendChild(stopSelectedButton);

                tracks.forEach((trackFile, index) => {
                    const audioElement = new Audio(URL.createObjectURL(trackFile));
                    const volumeControl = document.createElement('input');
                    const checkbox = document.createElement('input');
                    const playButton = document.createElement('button');
                    const stopButton = document.createElement('button');
                    const trackContainer = document.createElement('div');
                    const trackLabel = document.createElement('span');
                    const progressBar = document.createElement('input');

                    trackContainer.className = 'track-container';
                    trackLabel.className = 'track-label';
                    trackLabel.textContent = trackFile.name;

                    volumeControl.type = 'range';
                    volumeControl.min = 0;
                    volumeControl.max = 1;
                    volumeControl.step = 0.01;
                    volumeControl.value = 1;
                    volumeControl.className = 'volume-control';

                    volumeControl.addEventListener('input', () => {
                        audioElement.volume = volumeControl.value;
                    });

                    playButton.textContent = 'Přehrát';
                    playButton.className = 'play-button';
                    playButton.addEventListener('click', () => {
                        if (audioElement.paused) {
                            audioElement.play();
                            playButton.textContent = 'Pauza';
                        } else {
                            audioElement.pause();
                            playButton.textContent = 'Přehrát';
                        }
                    });

                    stopButton.textContent = 'Zastavit';
                    stopButton.className = 'stop-button';
                    stopButton.addEventListener('click', () => {
                        audioElement.pause();
                        audioElement.currentTime = 0;
                        playButton.textContent = 'Přehrát';
                    });

                    checkbox.type = 'checkbox';
                    checkbox.className = 'track-checkbox';

                    progressBar.type = 'range';
                    progressBar.min = 0;
                    progressBar.max = 100;
                    progressBar.value = 0;
                    progressBar.className = 'progress-bar';
                    progressBar.disabled = true;

                    audioElement.addEventListener('timeupdate', () => {
                        progressBar.value = (audioElement.currentTime / audioElement.duration) * 100;
                    });

                    trackContainer.appendChild(checkbox);
                    trackContainer.appendChild(trackLabel);
                    trackContainer.appendChild(playButton);
                    trackContainer.appendChild(stopButton);
                    trackContainer.appendChild(document.createTextNode(' Progress: '));
                    trackContainer.appendChild(progressBar);
                    trackContainer.appendChild(document.createTextNode(' Hlasitost: '));
                    trackContainer.appendChild(volumeControl);
                    trackControls.appendChild(trackContainer);

                    audioElements.push({ audio: audioElement, checkbox: checkbox, volumeControl: volumeControl });
                });
            }

            playSelectedButton.addEventListener('click', () => {
                audioElements.forEach(({ audio, checkbox }) => {
                    if (checkbox.checked) {
                        audio.play();
                    }
                });
            });

            stopSelectedButton.addEventListener('click', () => {
                audioElements.forEach(({ audio, checkbox }) => {
                    if (checkbox.checked) {
                        audio.pause();
                        audio.currentTime = 0;
                    }
                });
            });
        });
    </script>
</body>
</html>